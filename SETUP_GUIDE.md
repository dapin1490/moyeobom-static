# 모여봄 설치 및 실행 가이드

> 💡 **이 가이드는 개발자가 아닌 사용자를 위한 설치 및 실행 매뉴얼입니다.**
>
> 기술적인 세부사항이 필요하시면 [README.md](README.md)를 참고해주세요.

---

## 📋 시작하기 전에 확인할 것들

실행 전에 다음 항목들을 확인해주세요:

- [ ] **Python이 설치되어 있나요?** (버전 3.10 이상 권장)
- [ ] **Anaconda가 설치되어 있나요?** (없어도 되지만 있으면 더 쉽습니다)
- [ ] **웹캠이 연결되어 있나요?** (실시간 분석을 위해 필요합니다)
- [ ] **인터넷 연결이 가능한가요?** (첫 실행 시 모델 파일 다운로드에 필요합니다)
- [ ] **프로젝트 폴더 경로를 알고 있나요?** (예: `C:\Users\...\moyeobom`)
- [ ] **GPU가 있는 PC인가요?** (있으면 성능이 훨씬 좋습니다! 아래 GPU 확인 방법 참고)

---

## 🚀 빠른 시작 (3단계)

### 1단계: 터미널/명령 프롬프트 열기

**Windows:**
- `Win + R` 키를 누르고 `cmd` 입력 후 Enter
- 또는 시작 메뉴에서 "명령 프롬프트" 검색

**Mac:**
- `Cmd + Space` 키를 누르고 "터미널" 검색

### 2단계: 프로젝트 폴더로 이동

터미널에서 다음 명령어를 입력하세요 (프로젝트 폴더 경로에 맞게 수정):

```bash
cd C:/Users/사용자이름/Desktop/moyeobom
```

> 💡 **팁:** 프로젝트 폴더를 탐색기에서 찾아서 주소창의 경로를 복사하면 됩니다.

### 3단계: 실행

```bash
python app.py
```

성공하면 다음과 같은 메시지가 보입니다:
```
 * Running on http://0.0.0.0:5000
```

이제 웹 브라우저에서 [http://localhost:5000](http://localhost:5000)으로 접속하세요!

---

## 📦 처음 설치하는 경우 (상세 가이드)

### Step 1: Python 설치 확인

터미널에서 다음 명령어를 입력하세요:

```bash
python --version
```

**Python이 설치되어 있지 않은 경우:**
1. [Python 공식 웹사이트](https://www.python.org/downloads/)에서 다운로드
2. 설치 시 **"Add Python to PATH"** 옵션을 반드시 체크하세요
3. 설치 완료 후 터미널을 다시 열고 위 명령어로 확인

### Step 2: GPU 확인 (권장)

**GPU가 있으면 프로그램이 훨씬 빠르게 실행됩니다!** 특히 실시간으로 여러 명을 분석할 때 차이가 큽니다.

**GPU 확인 방법:**

**Windows:**
1. 작업 관리자 열기 (`Ctrl + Shift + Esc`)
2. "성능" 탭 클릭
3. 왼쪽에서 "GPU" 항목이 보이면 GPU가 있는 것입니다
4. 또는 `Win + R` → `dxdiag` 입력 → "표시" 탭에서 GPU 정보 확인

**Mac:**
- Mac은 일반적으로 GPU가 내장되어 있습니다 (M1/M2/M3 칩 또는 Intel Mac)

> 💡 **참고:** GPU가 없어도 프로그램은 정상 작동합니다. 다만 처리 속도가 느릴 수 있습니다.

### Step 3: Anaconda 설치 (선택사항이지만 권장)

**Anaconda가 있는 경우:**
```bash
conda create -n moyeobom python=3.10
conda activate moyeobom
```

**Anaconda가 없는 경우:**
- [Anaconda 공식 웹사이트](https://www.anaconda.com/download)에서 다운로드
- 또는 Step 4로 바로 진행해도 됩니다 (가상환경 없이 사용)

### Step 4: 필요한 프로그램 설치

프로젝트 폴더에서 다음 명령어 중 하나를 실행하세요:

#### 🚀 GPU가 있는 경우 (권장)

**GPU 버전으로 설치하면 훨씬 빠릅니다!**

먼저 GPU 버전 PyTorch를 설치하세요:
```bash
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
```

그 다음 나머지 패키지를 설치하세요:
```bash
pip install -r requirements.txt
```

> 💡 **참고:** 위 명령어는 NVIDIA GPU (CUDA 12.1)용입니다.  
> 다른 GPU를 사용하거나 오류가 발생하면 아래 "[GPU 버전 설치 오류 또는 GPU를 사용하지 못함](#문제-7-gpu-버전-설치-오류-또는-gpu를-사용하지-못함)" 섹션을 참고하세요.

#### 💻 GPU가 없거나 일반 버전 설치

**방법 1: requirements.txt 사용 (권장)**
```bash
pip install -r requirements.txt
```

**방법 2: 개별 패키지 설치**
```bash
pip install ultralytics flask norfair opencv-python numpy torch
```

> 💡 **팁:** `requirements.txt` 파일이 있다면 방법 1을 사용하는 것이 더 쉽고 안전합니다.  
> ⏱️ **시간이 걸릴 수 있습니다** (5-10분 정도, 인터넷 속도에 따라 다름)  
> ⚠️ **주의:** GPU가 있어도 일반 버전을 설치하면 GPU를 사용하지 못합니다. 가능하면 GPU 버전을 설치하세요!

### Step 5: 실행

```bash
python app.py
```

---

## 🌐 웹 브라우저에서 사용하기

프로그램이 실행되면 다음 주소로 접속할 수 있습니다:

| 페이지 | 주소 | 설명 |
|--------|------|------|
| **메인 페이지** | [http://localhost:5000](http://localhost:5000) | 시작 페이지 |
| **사람 수 카운팅** | [http://localhost:5000/count_view](http://localhost:5000/count_view) | 실시간으로 사람 수를 세는 페이지 |
| **혼잡도 분석** | [http://localhost:5000/area_view](http://localhost:5000/area_view) | 혼잡도를 분석하는 페이지 |
| **지도 뷰** | [http://localhost:5000/map_view](http://localhost:5000/map_view) | 지도 화면 |
| **비디오 분석** | [http://localhost:5000/video_view](http://localhost:5000/video_view) | 저장된 비디오 파일 분석 |

---

## ⚠️ 자주 발생하는 문제와 해결 방법

### 문제 1: "python이 내부 또는 외부 명령으로 인식되지 않습니다"

**원인:** Python이 설치되지 않았거나 PATH에 등록되지 않음

**해결 방법:**
1. Python을 설치했는지 확인
2. 설치 시 "Add Python to PATH" 옵션을 체크했는지 확인
3. 터미널을 완전히 종료하고 다시 열기
4. 그래도 안 되면 `py` 명령어로 시도:
    ```bash
    py app.py
    ```

### 문제 2: "포트가 이미 사용 중입니다" 또는 "Address already in use"

**원인:** 이미 프로그램이 실행 중이거나 다른 프로그램이 포트 5000을 사용 중

**해결 방법:**
1. 다른 터미널 창에서 프로그램이 실행 중인지 확인
2. 실행 중인 프로그램을 종료 (터미널에서 `Ctrl + C` 누르기)
3. 다른 프로그램이 포트를 사용 중이라면, 해당 프로그램을 종료

### 문제 3: "웹캠을 찾을 수 없습니다" 또는 카메라가 작동하지 않음

**원인:** 웹캠이 연결되지 않았거나 다른 프로그램에서 사용 중

**해결 방법:**
1. 웹캠이 제대로 연결되어 있는지 확인
2. 다른 프로그램(줌, 스카이프 등)에서 웹캠을 사용 중인지 확인하고 종료
3. 웹캠 권한이 허용되어 있는지 확인 (Windows 설정 > 개인 정보 > 카메라)

### 문제 4: "모듈을 찾을 수 없습니다" (ModuleNotFoundError)

**원인:** 필요한 프로그램이 설치되지 않음

**해결 방법:**
프로젝트 폴더에서 다음 명령어 중 하나를 실행하세요:

**방법 1: requirements.txt 사용 (권장)**
```bash
pip install -r requirements.txt
```

**방법 2: 개별 패키지 설치**
```bash
pip install ultralytics flask norfair opencv-python numpy torch
```

### 문제 5: 프로그램이 너무 느리게 실행됩니다

**원인:** 첫 실행 시 모델 파일을 다운로드하거나, 컴퓨터 성능이 낮을 수 있음

**해결 방법:**
1. 첫 실행은 시간이 걸릴 수 있습니다 (모델 다운로드)
2. 인터넷 연결을 확인하세요
3. 다른 프로그램을 종료하여 컴퓨터 자원 확보

### 문제 6: "yolo11x.pt 파일을 찾을 수 없습니다"

**원인:** 모델 파일이 없거나 경로가 잘못됨

**해결 방법:**
1. 첫 실행 시 자동으로 다운로드됩니다
2. 인터넷 연결을 확인하세요
3. 다운로드가 완료될 때까지 기다리세요

### 문제 7: GPU 버전 설치 오류 또는 GPU를 사용하지 못함

**원인:** GPU 드라이버가 설치되지 않았거나, 잘못된 CUDA 버전 설치

**해결 방법:**

**1단계: GPU 드라이버 확인**
- NVIDIA GPU인 경우: [NVIDIA 드라이버 다운로드](https://www.nvidia.com/Download/index.aspx)에서 최신 드라이버 설치
- 드라이버 설치 후 컴퓨터 재시작

**2단계: CUDA 버전 확인**
- NVIDIA 제어판에서 CUDA 버전 확인
- 또는 터미널에서 `nvidia-smi` 명령어로 확인

**3단계: 올바른 CUDA 버전으로 재설치**
- CUDA 11.8인 경우:
    ```bash
    pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118
    ```
- CUDA 12.1인 경우:
    ```bash
    pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121
    ```
- CUDA 버전을 모르는 경우, 일반 버전으로 설치해도 작동합니다:
    ```bash
    pip install torch torchvision torchaudio
    ```

**4단계: GPU 사용 확인**
- 프로그램 실행 후 터미널 메시지에서 GPU 사용 여부 확인
- 또는 작업 관리자에서 GPU 사용률 확인

> 💡 **팁:** GPU 설치가 복잡하면 일반 버전으로 설치해도 프로그램은 정상 작동합니다. 다만 속도가 느릴 수 있습니다.

---

## 🎨 전시 전 체크리스트

전시를 준비할 때 다음 항목들을 확인하세요:

### 하드웨어 확인
- [ ] 웹캠이 제대로 연결되어 있고 작동하는가?
- [ ] 컴퓨터가 전시 기간 동안 켜져 있을 수 있는가?
- [ ] 전원이 안정적으로 공급되는가?
- [ ] GPU가 있는 PC인가? (있으면 성능이 훨씬 좋습니다)
- [ ] GPU 버전으로 설치했는가? (GPU가 있는 경우)

### 소프트웨어 확인
- [ ] 프로그램이 정상적으로 실행되는가?
- [ ] 모든 페이지가 제대로 로드되는가?
- [ ] 웹 브라우저가 자동으로 열리도록 설정되어 있는가?

### 테스트
- [ ] 실제 웹캠으로 테스트해보았는가?
- [ ] 여러 명이 동시에 보일 때 정상 작동하는가?
- [ ] 비디오 파일이 있다면 재생이 되는가?

### 백업 계획
- [ ] 문제 발생 시 대체 방법이 있는가?
- [ ] 연락할 수 있는 기술 지원자가 있는가?

---

## 📝 프로그램 종료 방법

프로그램을 종료하려면:

1. 프로그램이 실행 중인 터미널 창을 클릭
2. `Ctrl + C` 키를 누르기 (Mac은 `Cmd + C`)
3. "정말 종료하시겠습니까?" 같은 메시지가 나오면 `Y` 입력

---

## 🔧 간단한 설정 변경

설정을 변경하려면 `config.json` 파일을 수정하면 됩니다! 코드를 직접 수정할 필요가 없습니다.

### 📝 config.json 파일 열기

프로젝트 폴더에서 `config.json` 파일을 메모장이나 텍스트 에디터로 엽니다.

### 포트 번호 변경 (다른 프로그램과 충돌할 때)

`config.json` 파일에서 다음 부분을 찾아서:
```json
"server": {
  "host": "0.0.0.0",
  "port": 5000,
  "debug": true
}
```
`"port": 5000`을 다른 번호로 변경 (예: `"port": 5001`)

그러면 `http://localhost:5001`로 접속해야 합니다.

### 혼잡도 기준 변경

`config.json` 파일에서 다음 부분을 찾아서:
```json
"complex_ratio": {
  "low_threshold": 30,
  "high_threshold": 70
}
```
숫자를 변경하면 혼잡도 기준이 바뀝니다.
- `low_threshold`: 여유와 보통의 경계 (기본값: 30)
- `high_threshold`: 보통과 혼잡의 경계 (기본값: 70)

### 웹캠 변경

여러 개의 웹캠이 연결되어 있을 때 다른 웹캠을 사용하려면:
```json
"camera": {
  "index": 0
}
```
`"index": 0`을 `"index": 1` 또는 `"index": 2` 등으로 변경하세요.

### 추적기 민감도 조정

객체 추적이 너무 민감하거나 둔감할 때:
```json
"tracker": {
  "distance_threshold": 120
}
```
- 값이 클수록: 더 멀리 있는 객체도 같은 객체로 인식 (더 민감)
- 값이 작을수록: 가까운 객체만 같은 객체로 인식 (덜 민감)

> ⚠️ **주의:** `config.json` 파일을 수정한 후에는 프로그램을 다시 시작해야 합니다.  
> 💡 **팁:** JSON 파일을 수정할 때는 쉼표(`,`)와 따옴표(`"`)를 정확히 입력해야 합니다. 오타가 있으면 프로그램이 실행되지 않을 수 있습니다.

---

## ❓ 자주 묻는 질문 (FAQ)

### Q1: Python과 Anaconda의 차이는 무엇인가요?
**A:** Python은 프로그래밍 언어이고, Anaconda는 Python과 여러 유용한 도구들을 함께 제공하는 패키지입니다. Anaconda를 사용하면 더 쉽게 관리할 수 있지만, 없어도 됩니다.

### Q2: 가상환경이 뭔가요?
**A:** 프로젝트별로 필요한 프로그램들을 따로 관리하는 공간입니다. 다른 프로젝트와 충돌을 방지합니다. 없어도 작동하지만, 있으면 더 좋습니다.

### Q3: 인터넷이 없어도 실행할 수 있나요?
**A:** 첫 실행 시 모델 파일을 다운로드해야 하므로 인터넷이 필요합니다. 다운로드가 완료되면 오프라인에서도 실행 가능합니다.

### Q4: 여러 대의 컴퓨터에서 동시에 실행할 수 있나요?
**A:** 네, 각 컴퓨터마다 설치하고 실행하면 됩니다. 하지만 같은 네트워크에서 실행할 경우 포트 번호를 다르게 설정해야 할 수 있습니다.

### Q5: 비디오 파일은 어디에 넣어야 하나요?
**A:** `static/videos/` 폴더에 넣으세요. 그 폴더에 `.placeholder` 파일이 있다면 그대로 두고, 비디오 파일만 추가하면 됩니다.

### Q6: 프로그램이 실행되지 않아요. 어떻게 해야 하나요?
**A:**
1. 위의 "자주 발생하는 문제" 섹션을 확인하세요
2. 터미널에 나타나는 오류 메시지를 확인하세요
3. 기술 지원자에게 오류 메시지를 보여주세요

### Q7: 전시 중에 문제가 생기면 어떻게 하나요?
**A:**
1. 프로그램을 종료하고 다시 시작해보세요 (`Ctrl + C` 후 `python app.py`)
2. 컴퓨터를 재시작해보세요
3. 웹캠 연결을 확인하세요
4. 미리 연락처를 확인해두고 기술 지원자에게 연락하세요

### Q8: GPU가 없어도 사용할 수 있나요?
**A:** 네, GPU가 없어도 프로그램은 정상 작동합니다. 다만 처리 속도가 느릴 수 있으므로, 가능하면 GPU가 있는 PC를 사용하는 것을 권장합니다.

### Q9: GPU 버전과 일반 버전의 차이는 무엇인가요?
**A:** GPU 버전은 딥러닝 모델을 GPU에서 실행하여 처리 속도가 훨씬 빠릅니다. 일반 버전은 CPU만 사용하므로 느릴 수 있습니다. 전시 환경에서는 GPU 버전을 사용하는 것이 좋습니다.

### Q10: GPU 버전 설치가 실패했어요. 어떻게 하나요?
**A:** GPU 버전 설치가 실패하거나 복잡하면 일반 버전으로 설치해도 됩니다. `pip install -r requirements.txt` 명령어로 설치하면 자동으로 일반 버전이 설치됩니다. 프로그램은 정상 작동하지만 속도가 느릴 수 있습니다.

---

## 📞 도움이 필요하신가요?

문제가 해결되지 않으면:
1. 터미널에 나타난 오류 메시지를 복사해두세요
2. 기술 지원자에게 오류 메시지와 함께 문의하세요
3. [README.md](README.md) 파일을 참고하여 더 자세한 정보를 확인하세요

---

## 🎯 요약: 가장 빠른 실행 방법

### GPU가 있는 경우 (권장)
1. 터미널 열기
2. 프로젝트 폴더로 이동: `cd [프로젝트 경로]`
3. GPU 버전 설치: `pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu121`
4. 나머지 패키지 설치: `pip install -r requirements.txt`
5. 실행: `python app.py`
6. 브라우저에서 [http://localhost:5000](http://localhost:5000) 접속

### GPU가 없는 경우
1. 터미널 열기
2. 프로젝트 폴더로 이동: `cd [프로젝트 경로]`
3. 패키지 설치: `pip install -r requirements.txt`
4. 실행: `python app.py`
5. 브라우저에서 [http://localhost:5000](http://localhost:5000) 접속

끝! 🎉

---

**마지막 업데이트:** 2025년

**문서 버전:** 1.0

